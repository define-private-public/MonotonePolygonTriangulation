<!DOCTYPE html>
<html>

<head>
  <title>Polygon Triangulation</title>
  <!-- TODO manually incluce necessary CSS from blog -->
  <link rel="stylesheet" type="text/css" href="https://16bpp.net/statics/styles/main.css">
  <style type="text/css">
    .algorithm-case {
      border: 1px solid black;
      border-radius: 6px;
      margin: 6px 0px;
      padding: 6px;
    }

    h2.mini-header {
      margin-top: 0px;
      margin-bottom: 8px;
    }

    #control-section {
      float: left;
      width: 140px;
    }

    #control-section button {
      width: 100%;
      margin: 2px 0px;;
    }

    #polygon-canvas {
      float: left;
    }

    /*== TODO nicer CSS here ==*/
    button.toggle-on {
      border: 4px solid blue;
    }
  </style>
</head>

<body>
  <div id="content" style="max-width:750px">
    <h1>X-Monotone Polygon Triangulation</h1>
    <div class="row">
      <div id="interactive">
        <canvas id="polygon-canvas" width="560" height="420"></canvas>
        
        <!-- vertical spacer -->
        <div style="float: left;width: 8px;">&nbsp;</div>

        <div id="control-section">
          <h2 class="mini-header">Controls:</h2>

          <p>Use the Left Mouse Button to add points to the polygon.  Right Click to remove the last added point.</p>
          <p>If the Polygon turns red, that means that it isn't X Monotone and will not triangulate.</p>
          <p>At least four points are needed to Triangulate.</p>

          <button id="triangulate-toggle" disabled>Triangulate [Off]</button><br>
          <button id="step-through-toggle">Step Through [Off]</button><br>
          <button id="step" disabled>Step</button><br>
        </div>
      </div>
    </div>

    <div id="step-through-mode-info" class="row" style="display: none;">
      <p>The points with a purple ring around them are part of the Upper Chain, where as the ones with a green ring around them are from the Lower Chain.  If a ring is filled in with red, that means it's part of the Reflex Chain at that step.  The vertical red line marks which point is currently being tested.</p>
      <p>The boxes below highlight which case of the algorithm the current point is hitting.</p>
    </div>

    <div id="algorithm" class="algorithm-case row">
      <span style="background: yellow">TODO: rewrite the steps to be a bit more accurate</span>

      <h2 class="mini-header">Algorithm:</h2>
      <div id="step-one">Sort the points by an ascending X value.</div>
      <div id="step-two">Push the first two points onto the Reflex Chain.</div>

      <div id="case-one" class="algorithm-case">
        <strong>Case 1:</strong> Current point is on a different chain of the Polygon<br />
        <br />
        Draw a diagonal from each point on the Relfex Chain to the new point.<br />
        <em>v</em> = last point on the Relfex Chain<br />
        Clear the Relfex Chain<br />
        Put <em>v</em> back onto the Relfex Chain<br />
        Put the new point onto the Reflex Chain
      </div>

      <div id="case-two" class="algoritm-case">
        <div id="case-two-a" class="algorithm-case">
          <strong>Case 2a:</strong> Current point is visible to some (or all) points on the chain.<br />
          <br />
          Draw a diagonal from each point on the Reflex Chain that is visible<br />
          to the new point.<br />
          Remove all of the points from the Relfex Chain where there was a diagonal draw,<br />
          except for the last diagonal.<br />
          Add the new point to the Reflex Chain.
        </div>

        <div id="case-two-b" class="algorithm-case">
          <strong>Case 2b:</strong> Current point is not visible to any other points on the chain<br />
          <br />
          Just add the new point to the Relfex Chain
        </div>
      </div>
    </div>
  </div>
    
<!--
      <p>
        <em style="font-size:12px;">Please enter points in a clock-wise order.</em>
      </p>
        </td>
      </tr>
    </table>
  <br />
  <div id="controls">
    <p>Controls:</p>
    <button id="step_through"></button>
    <button id="triangulate"></button>
    <button id="step"></button>

    <p>Info:</p>
    <div id="info_side"></div>
    <div id="info_p"></div>
    <div id="info_reflex_chain"></div>
    <div id="info_upper_chain"></div>
    <div id="info_lower_chain"></div>

  </div>

-->

  <script type="application/dart" src="triangulate.dart"></script>
<!--  <script type="application/javascript" src="out.js"></script> -->
</body>

</html>
