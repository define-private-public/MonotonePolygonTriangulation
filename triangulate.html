<!DOCTYPE html>
<html>

<head>
  <title>Polygon Triangulation</title>
  <!-- TODO manually incluce necessary CSS from blog -->
  <link rel="stylesheet" type="text/css" href="https://16bpp.net/statics/styles/main.css">
  <style type="text/css">

    /* CSS for this app */
    .algorithm-case {
      border: 1px solid black;
      border-radius: 6px;
      margin: 6px 0px;
      padding: 6px;
      background: white;
    }

    .algorithm-case .current {
      background: #FFC060;
    }

    h2.mini-header {
      margin-top: 0px;
      margin-bottom: 8px;
    }

    #control-section {
      float: left;
      width: 140px;
    }

    #control-section button {
      width: 100%;
      margin: 2px 0px;;
    }

    #polygon-canvas {
      float: left;
    }

    button.toggle-on {
      border: 4px solid orange;
      border-radius: 2px;
    }
  </style>
</head>

<body>
  <div id="content" style="max-width:750px">
    <h1>X-Monotone Polygon Triangulation</h1>
    <div class="row">
      <div id="interactive">
        <canvas id="polygon-canvas" width="560" height="420"></canvas>
        
        <!-- vertical spacer -->
        <div style="float: left;width: 8px;">&nbsp;</div>

        <div id="control-section">
          <h2 class="mini-header">Controls:</h2>

          <p>Use the Left Mouse Button to add points to the polygon.  Right Click to remove the last added point.</p>
          <p>If the Polygon turns red, that means that it isn't X Monotone and will not triangulate.</p>
          <p>At least four points are needed to Triangulate.</p>

          <button id="triangulate-toggle" disabled>Triangulate [Off]</button><br>
          <button id="step" disabled>Step</button><br>
          <button id="step-through-toggle">Step Through [Off]</button><br>
          <div style="height: 24px;">&nbsp;</div>
          <button id="clear" disabled>Clear</button><br> 
        </div>
      </div>
    </div>

    <div id="step-through-mode-info" class="row" style="display: none;">
      <p>The points with a purple ring around them are part of the Upper Chain, where as the ones with a green ring around them are from the Lower Chain.  If a ring is filled in with red, that means it's part of the Reflex Chain at that step.  The vertical red line marks which point is currently being tested.</p>
      <p>The boxes below highlight which case of the algorithm the current point is hitting.</p>
    </div>

    <div id="algorithm" class="algorithm-case row">
      <h2 class="mini-header">Algorithm:</h2>
      <p>First split the Polygon into two chains, an Upper Chain that contains the topmost Points, and a Lower Chain that contains the bottommost Points.</p>
      <p>With respect to an ascending X axis value, push the first two Points from the Upper &amp; Lower Chains onto the Reflex Chain (Which is a LIFO).</p>

      <div id="case-one" class="algorithm-case">
        <strong>Case 1:</strong> The current Point (<em>p</em>) is on an opposite side of the Reflex Chain <br>
        <br>
        <em>v</em> = topmost Point on the Reflex Chain.<br>
        Draw a diagonal from each Point on the Reflex Chain to <em>p</em>.<br>
        Clear the Reflex Chain.<br>
        Push <em>v</em> back onto the Reflex Chain.<br>
        Push <em>p</em> onto the Reflex Chain.
      </div>

      <div id="case-two" class="algoritm-case">
        <div id="case-two-a" class="algorithm-case">
          <strong>Case 2a:</strong> The current Point (<em>p</em>) is visible to some (or all) Points on the Reflex Chain.<br>
          <br>
          Draw a diagonal from each point on the Reflex Chain that is visible to <em>p</em>.<br>
          Remove all of the Points from the Reflex Chain where there was a diagonal drawn, except for the last one.<br>
          Add <em>p</em> to the Reflex Chain.
        </div>

        <div id="case-two-b" class="algorithm-case">
          <strong>Case 2a:</strong> The current Point (<em>p</em>) is not visible to any Points on the Reflex Chain.<br>
          <br>
          Just add <em>p</em> to the Reflex Chain.
        </div>
      </div>
    </div>
  </div>

<!--  <script type="application/dart" src="triangulate.dart"></script> -->
  <script type="application/javascript" src="out.js"></script>
</body>

</html>
